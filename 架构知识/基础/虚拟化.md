

# 虚拟化

## 概念

### ISA
* 指令集架构 `Instruction Set Architecture`
* 包含一系列操作码（机器语言）和 特定处理器的基本命令

### ABI
* 应用二进制接口 `Application Binary Interfact`
* 应用程序与操作系统之间或其他依赖库之间的低级接口
* 包括：数据类型的宽度大小、对象的布局、接口调用的约定


## 分类

### 指令集虚拟化（仿真）
* 通过软件来模拟不同ISA的处理器
* 例子：QEMU，Bochs

#### 特点
* 完全的兼容性
* 性能损失最大

### 硬件抽象层虚拟化（虚拟机）
* 通过软件、硬件来模拟各种设备的工作过程
    * 处理器、内存、磁盘控制器、显卡
* 例子：VMware，Hyer-V


### 操作系统层虚拟化（容器化）
* 采用隔离的手段，使进程拥有独立的系统资源

#### 特点
* 牺牲一定的隔离性、兼容性
* 更高的运行性能、启动速度
* 更低的执行负担


### 运行库层虚拟化
* 使用软件翻译来模拟系统
* 例子：WINE, WSL


## 容器技术

### 隔离文件（chroot）
* 修改进程的根目录


### 隔离访问（名称空间）
* 内核直接提供的全局资源封禁技术
* 内核针对进程设计的访问隔离机制

#### 资源类型
* `Mount` 隔离文件系统
* `UTS` 隔离主机的hostname, domainname
* `IPC` 隔离进程间通信的渠道
* `PID` 隔离进程编号
* `Network` 隔离网络资源
* `User` 隔离用户、用户组
* `Cgroup` 隔离cgroups信息
* `Time` 隔离系统时间

### 隔离资源（cgroups）
* 限制进程组能够使用的资源配额
* 包含：处理器时间、内存大小、磁盘IO速度


### 封装系统（LXC）
* 一种封装系统的轻量级虚拟机


### 封装应用（Docker）
* 以应用为中心进行封装
* 提供了一种将应用及其依赖的环境都打包在一起的格式