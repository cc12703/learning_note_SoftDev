

# 云原生架构

## 概述

### 含义
* 基于云环境，专为云端特性设计
* 充分利用和发挥云的弹性、分布式优势


### 目的
* 将非业务代码部分最大化的剥离
* 将非功能性特性剥离到IaaS、PaaS中

#### 代码类型
* 业务代码
* 三方软件
* 处理非功能特性的代码


## 原则

### 服务化原则
* 对代码进行服务化拆分（微服务架构、小服务架构）
* 把不同生命周期的模块分离出来，分别进行迭代

### 弹性原则
* 系统的部署规则可以随业务量的变化而自动伸缩

### 可观测原则
* 主动通过日志、链路跟踪、度量手段，获得关联分析能力


### 韧性原则
* 当所依赖的软硬件出现异常时，系统所表现出的抵御能力
* 核心目标：提升软件的MTBF(平均无故障时间)


### 全自动化原则
* 实现整个软件交付和运维的自动化
* 方法：标准化软件交付过程、在标准化基础上进行自动化

### 零信任原则
* 思想：默认情况下，不信任网络内外的任何设备、系统
* 核心：以身份为中心进行访问控制


### 持续演进原则
* 对架构进行一定范围内的重构


## 模式

### 服务化模式
* 云原生应用的标准架构模式
* 典型：微服务、小服务

#### 要点
* 以应用模块为颗粒度来划分软件
* 以接口契约来定义业务关系
* 以标准协议来互联互通


### Mesh化模式

#### 要点
* 把中间件从业务进程中剥离
* 大量的分布式功能由mesh进程完成
    * 熔断、限流、降级、重试、反压


### Serverless模式
* 将应用的整个运行都委托给云

#### 适用类型
* 事件驱动的数据计算任务
* 计算时间短的请求/响应应用
* 无复杂相互调用的长周期任务

### 存储计算分离模式
* 将持久化数据交由云服务来保存
    * 暂态数据、结构化数据、非结构化数据



### 可观测架构

#### 类型
* `Logging`: 提供多个级别的详细信息跟踪
* `Tracing`: 提供一个请求从前端到后端的完整调用链路跟踪
* `Metrics`: 提供对系统量化的多维度度量



## 相关技术

### 容器技术

* 容器作为标准化软件单元，使应用不再受环境限制。
* `镜像`解耦了应用与运行环境


### 容器编排
* 行业标准：k8s

#### 核心能力
* 资源调度
* 应用部署与管理
* 自动修复
* 服务发现、负载均衡
* 弹性伸缩
* 声明式API：开发者关注于应用本身
* 可扩展性架构
* 可移植性



### 微服务


#### 设计约束
* 个体约束：业务域的划分应该是相互独立的
* 横向关系：服务的可发现性、可交互性
* 纵向约束：数据存储隔离，数据是微服务的私有资产
* 分布式约束：自动化的CI/CD流水线、可观测能力


### 服务网格

#### 技术特点
* 将微服务间的通用功能下沉为平台的基础设施
* 将大量非功能性从业务进程剥离到其他进程中
