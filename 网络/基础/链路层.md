

# 链路层

[TOC]



## 概述

* PDU（协议数据单元）为 `帧`
* 标准：`IEEE 802.3` 或 `以太网`



## 以太网

### 数据帧
* 单播帧：目的地址为广播、多播地址以外的地址
* 广播帧：目的地址为`FF:FF:FF:FF`
* 多播帧：目的地址为多播地址
* 不完全帧：长度为63字节以下的帧（有冲突导致的坏帧）
* 小巨人帧：比1518字节稍大的帧
* 巨型帧：比1518字节大很多的帧


## 局域网


### 类别

#### 共享式以太网
* 多个站共享同一个网络（连接到一个电缆上）
* 使用CSMA/CD（带冲突检测的载波侦听多路访问）算法来发送数据
    * 任意给定的时间内，网络中只能有一个帧传输
* 工作在半双工模式

#### 交换式以太网
* 工作在全双工模式




### MAC地址
* 网卡的物理地址
* 一个唯一标识，像身份证
* 作用：保证不同网卡在同一网络中不会发生冲突



### 帧格式

![](http://picbed.cc12703.com/20230128005759.png)

* 前导字段：用于接收器确定帧的到达时间
* SFD：帧起始分隔符
* FCS：帧校验序列，用于检查帧完整性
* 类型字段：确定头部后面的数据类型
    * `0x0800` IPv4
    * `0x86DD` IPv6
    * `0x0806` ARP
    * `0x8100` Q标签


### 虚拟局域网（VLAN）

* 在第二层协议头中增加一个TAG数据，使用VLAN ID来组成局域网
* 交换机之间通过Trunk口进行互联

![](http://picbed.cc12703.com/20230120124827.png)



## 无线局域网

### 标准
* IEEE 802.11


### 结构

![](http://picbed.cc12703.com/20230129004751.png)


### 帧格式

![](http://picbed.cc12703.com/20230129004852.png)




## 设备


### 交换机
* 别名：交换式集线器
* 通过学习得到每个连接终端的MAC地址

#### 帧传输

##### 直通转发
* 只读取帧最初的14个字节，就进行转发
* 优点：时延最小
* 缺点：无法检测并丢弃错误帧

##### 碎片隔离
* 读取帧前64个字节，在进行转发
* 优点：防止了转发错误帧

##### 存储转发
* 读取帧的所有内容后再转发
* 还可以对帧进行缓存操作
* 优点：桥接不同速率的以太网


#### 架构

* 组件： `RJ-45接口`，`PHY`, `MAC`，`NIC`, `缓存`，`转发表`
* NIC: 网络接口控制器

![](http://picbed.cc12703.com/20240908233013.png)